// –î–∞–Ω–Ω—ã–µ –æ –ø—Ä–æ–¥—É–∫—Ç–∞—Ö
const products = {
    1: {
        name: "–°–≤–∏—Ç—à–æ—Ç Hermes",
        brand: "hermes",
        price: 129,
        description: "–ü—Ä–µ–º–∏–∞–ª—å–Ω—ã–π —Å–≤–∏—Ç—à–æ—Ç –æ—Ç Hermes —Å —Ñ–∏—Ä–º–µ–Ω–Ω—ã–º –ª–æ–≥–æ—Ç–∏–ø–æ–º. –ö–∞—á–µ—Å—Ç–≤–æ 1:1. –ò–¥–µ–∞–ª—å–Ω–∞—è –ø–æ—Å–∞–¥–∫–∞ –∏ –∫–æ–º—Ñ–æ—Ä—Ç.",
        features: [
            "–ú–∞—Ç–µ—Ä–∏–∞–ª: –ø—Ä–µ–º–∏–∞–ª—å–Ω—ã–π —Ö–ª–æ–ø–æ–∫",
            "–ö–∞—á–µ—Å—Ç–≤–æ 1:1",
            "–§–∏—Ä–º–µ–Ω–Ω–∞—è –±–∏—Ä–∫–∞ –∏ —É–ø–∞–∫–æ–≤–∫–∞",
            "–î–æ—Å—Ç—É–ø–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã: S, M, L, XL"
        ],
        images: [
            "hermeshud1.jpg",
            "hermeshud2.jpg",
            "hermeshud3.jpg",
            "hermeshud4.jpg",
            "hermeshud5.jpg",
            "hermeshud6.jpg",
        ]
    },
    2: {
        name: "–°–≤–∏—Ç—à–æ—Ç Burberry",
        brand: "burberry",
        price: 114,
        description: "–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π —Å–≤–∏—Ç—à–æ—Ç Burberry —Å —É–∑–Ω–∞–≤–∞–µ–º—ã–º –∫–ª–µ—Ç—á–∞—Ç—ã–º —É–∑–æ—Ä–æ–º. –í—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –ø–æ—à–∏–≤–∞.",
        features: [
            "–ú–∞—Ç–µ—Ä–∏–∞–ª: –≤—ã—Å–æ–∫–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Ö–ª–æ–ø–æ–∫",
            "–£–∑–Ω–∞–≤–∞–µ–º—ã–π –∫–ª–µ—Ç—á–∞—Ç—ã–π —É–∑–æ—Ä",
            "–§–∏—Ä–º–µ–Ω–Ω–∞—è –±–∏—Ä–∫–∞",
            "–†–∞–∑–º–µ—Ä—ã: M, L"
        ],
        images: [
            "–°–í–ò–¢–®–û–¢–´ BURBERRY1.jpg",
            "–°–í–ò–¢–®–û–¢–´ BURBERRY2.jpg",
            "–°–í–ò–¢–®–û–¢–´ BURBERRY3.jpg",
            "–°–í–ò–¢–®–û–¢–´ BURBERRY4.jpg",
            "–°–í–ò–¢–®–û–¢–´ BURBERRY5.jpg",
            "–°–í–ò–¢–®–û–¢–´ BURBERRY6.jpg",
            "–°–í–ò–¢–®–û–¢–´ BURBERRY7.jpg"
        ]
    },
    3: {
        name: "–°–≤–∏—Ç—à–æ—Ç Lacoste",
        brand: "lacoste",
        price: 98,
        description: "–°–ø–æ—Ä—Ç–∏–≤–Ω—ã–π —Å–≤–∏—Ç—à–æ—Ç Lacoste —Å —Ñ–∏—Ä–º–µ–Ω–Ω—ã–º –∫—Ä–æ–∫–æ–¥–∏–ª–æ–º. –£–¥–æ–±—Å—Ç–≤–æ –∏ —Å—Ç–∏–ª—å –¥–ª—è –ø–æ–≤—Å–µ–¥–Ω–µ–≤–Ω–æ–π –Ω–æ—Å–∫–∏.",
        features: [
            "–ú–∞—Ç–µ—Ä–∏–∞–ª: —Ö–ª–æ–ø–æ–∫ —Å –Ω–µ–±–æ–ª—å—à–∏–º –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º —ç–ª–∞—Å—Ç–∞–Ω–∞",
            "–§–∏—Ä–º–µ–Ω–Ω—ã–π –∫—Ä–æ–∫–æ–¥–∏–ª",
            "–ö–æ–º—Ñ–æ—Ä—Ç–Ω–∞—è –ø–æ—Å–∞–¥–∫–∞",
            "–†–∞–∑–º–µ—Ä—ã: M, L"
        ],
        images: [
            "–°–í–ò–¢–®–û–¢–´ LACOSTE–±–µ–ª1.jpg",
            "–°–í–ò–¢–®–û–¢–´ LACOSTE–±–µ–ª2.jpg",
            "–°–í–ò–¢–®–û–¢–´ LACOSTE–±–µ–ª3.jpg",
            "–°–í–ò–¢–®–û–¢–´ LACOSTE–±–µ–ª4.jpg",
            "–°–í–ò–¢–®–û–¢–´ LACOSTE–±–µ–ª5.jpg",
            "–°–í–ò–¢–®–û–¢–´ LACOSTE–±–µ–ª6.jpg",
            "–°–í–ò–¢–®–û–¢–´ LACOSTE–±–µ–ª7.jpg"
        ]
    },
    4: {
        name: "–°–≤–∏—Ç—à–æ—Ç Lacoste —á–µ—Ä–Ω—ã–π",
        brand: "lacoste",
        price: 98,
        description: "–ß–µ—Ä–Ω—ã–π —Å–≤–∏—Ç—à–æ—Ç Lacoste –¥–ª—è —ç–ª–µ–≥–∞–Ω—Ç–Ω–æ–≥–æ –∏ —Å—Ç–∏–ª—å–Ω–æ–≥–æ –æ–±—Ä–∞–∑–∞. –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –Ω–∞ –ª—é–±–æ–π —Å–ª—É—á–∞–π.",
        features: [
            "–ú–∞—Ç–µ—Ä–∏–∞–ª: –ø—Ä–µ–º–∏–∞–ª—å–Ω—ã–π —Ö–ª–æ–ø–æ–∫",
            "–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π —á–µ—Ä–Ω—ã–π —Ü–≤–µ—Ç",
            "–§–∏—Ä–º–µ–Ω–Ω—ã–π –∫—Ä–æ–∫–æ–¥–∏–ª",
            "–†–∞–∑–º–µ—Ä—ã: S, M, L, XL"
        ],
        images: [
            "–°–í–ò–¢–®–û–¢–´ LACOSTE—á–µ—Ä1.jpg",
            "–°–í–ò–¢–®–û–¢–´ LACOSTE—á–µ—Ä2.jpg",
            "–°–í–ò–¢–®–û–¢–´ LACOSTE—á–µ—Ä3.jpg",
            "–°–í–ò–¢–®–û–¢–´ LACOSTE—á–µ—Ä4.jpg",
            "–°–í–ò–¢–®–û–¢–´ LACOSTE—á–µ—Ä5.jpg",
            "–°–í–ò–¢–®–û–¢–´ LACOST–ï—á–µ—Ä6.jpg",
        ]
    },
    5: {
        name: "–ó–∏–ø–∫–∞ Dior",
        brand: "dior",
        price: 149,
        description: "–°—Ç–∏–ª—å–Ω–∞—è –∑–∏–ø–∫–∞ –æ—Ç Dior —Å —Ñ–∏—Ä–º–µ–Ω–Ω—ã–º–∏ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏. –ö–∞—á–µ—Å—Ç–≤–æ 1:1. –ò–¥–µ–∞–ª—å–Ω—ã–π –≤—ã–±–æ—Ä –¥–ª—è –º–æ–¥–Ω–æ–≥–æ –æ–±—Ä–∞–∑–∞.",
        features: [
            "–ú–∞—Ç–µ—Ä–∏–∞–ª: –≤—ã—Å–æ–∫–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –ø–æ–ª–∏—ç—Å—Ç–µ—Ä",
            "–§–∏—Ä–º–µ–Ω–Ω–∞—è —Ñ—É—Ä–Ω–∏—Ç—É—Ä–∞",
            "–ö–∞—á–µ—Å—Ç–≤–æ 1:1",
            "–†–∞–∑–º–µ—Ä—ã: M, L"
        ],
        images: [
            "DIOR–∑–∏–ø1.jpg",
            "DIOR–∑–∏–ø2.jpg",
            "DIOR–∑–∏–ø3.jpg",
            "DIOR–∑–∏–ø4.jpg",
            "DIOR–∑–∏–ø5.jpg",
            "DIOR–∑–∏–ø6.jpg",
            "DIOR–∑–∏–ø7.jpg",
            "DIOR–∑–∏–ø8.jpg",
            "DIOR–∑–∏–ø9.jpg"
        ]
    },
    6: {
        name: "–õ–æ–Ω–≥—Å–ª–∏–≤ Guess",
        brand: "guess",
        price: 90,
        description: "–ú–æ–¥–Ω—ã–π –ª–æ–Ω–≥—Å–ª–∏–≤ –æ—Ç Guess —Å —É–∑–Ω–∞–≤–∞–µ–º—ã–º –ª–æ–≥–æ—Ç–∏–ø–æ–º. –ö–æ–º—Ñ–æ—Ä—Ç –∏ —Å—Ç–∏–ª—å –¥–ª—è –ø–æ–≤—Å–µ–¥–Ω–µ–≤–Ω–æ–π –Ω–æ—Å–∫–∏.",
        features: [
            "–ú–∞—Ç–µ—Ä–∏–∞–ª: —Ö–ª–æ–ø–æ–∫",
            "–£–∑–Ω–∞–≤–∞–µ–º—ã–π –ª–æ–≥–æ—Ç–∏–ø Guess",
            "–£–¥–æ–±–Ω—ã–π –∫—Ä–æ–π",
            "–†–∞–∑–º–µ—Ä—ã: M, L"
        ],
        images: [
            "–õ–æ–Ω–≥guess1.jpg",
            "–õ–æ–Ωgguess2.jpg",
            "–õ–æ–Ωgguess3.jpg",
            "–õ–æ–Ωgguess4.jpg",
            "–õ–æ–Ωgguess5.jpg",
            "–õ–æ–Ωgguess6.jpg",
            "–õ–æ–Ωgguess7.jpg"
        ]
    },
    7: {
        name: "–õ–æ–Ω–≥—Å–ª–∏–≤ Guess —á–µ—Ä–Ω—ã–π",
        brand: "guess",
        price: 90,
        description: "–ú–æ–¥–Ω—ã–π –ª–æ–Ωg—Å–ª–∏–≤ –æ—Ç Guess —Å —É–∑–Ω–∞–≤–∞–µ–º—ã–º –ª–æ–≥–æ—Ç–∏–ø–æ–º. –ö–æ–º—Ñ–æ—Ä—Ç –∏ —Å—Ç–∏–ª—å –¥–ª—è –ø–æ–≤—Å–µ–¥–Ω–µ–≤–Ω–æ–π –Ω–æ—Å–∫–∏.",
        features: [
            "–ú–∞—Ç–µ—Ä–∏–∞–ª: —Ö–ª–æ–ø–æ–∫",
            "–£–∑–Ω–∞–≤–∞–µ–º—ã–π –ª–æ–≥–æ—Ç–∏–ø Guess",
            "–£–¥–æ–±–Ω—ã–π –∫—Ä–æ–π",
            "–†–∞–∑–º–µ—Ä—ã: M, L"
        ],
        images: [
            "–õ–æ–Ωgguess—á–µ—Ä1.jpg",
            "–õ–æ–Ωgguess—á–µ—Ä2.jpg",
            "–õ–æ–Ωgguess—á–µ—Ä3.jpg",
            "–õ–æ–Ωgguess—á–µ—Ä4.jpg",
            "–õ–æ–Ωgguess—á–µ—Ä5.jpg",
            "–õ–æ–Ωgguess—á–µ—Ä6.jpg",
            "–õ–æ–Ωgguess—á–µ—Ä7.jpg"
        ]
    },
    8: {
        name: "–ñ–∏–ª–µ—Ç–∫–∞ Corteiz",
        brand: "corteiz",
        price: 139,
        description: "–£–ª–∏—á–Ω–∞—è –∂–∏–ª–µ—Ç–∫–∞ Corteiz –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –º–æ–¥–Ω–æ–≥–æ –æ–±—Ä–∞–∑–∞. –ö–∞—á–µ—Å—Ç–≤–æ 1:1. –°—Ç–∏–ª—å –∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å.",
        features: [
            "–ú–∞—Ç–µ—Ä–∏–∞–ª: –Ω–µ–π–ª–æ–Ω",
            "–í–æ–¥–æ–æ—Ç—Ç–∞–ª–∫–∏–≤–∞—é—â–∞—è –ø—Ä–æ–ø–∏—Ç–∫–∞",
            "–ù–µ—Å–∫–æ–ª—å–∫–æ –∫–∞—Ä–º–∞–Ω–æ–≤",
            "–†–∞–∑–º–µ—Ä—ã: M, L"
        ],
        images: [
            "photo_2025-07-01_17-31-38.jpg",
            "CORTEIZjil2.jpg",
            "CORTEIZjil3.jpg",
            "CORTEIZjil4.jpg",
            "CORTEIZjil5.jpg",
            "CORTEIZjil6.jpg",
            "CORTEIZjil7.jpg"
        ]
    },
    9: {
        name: "–ñ–∏–ª–µ—Ç–∫–∞ Jordan & Supreme",
        brand: "jordan",
        price: 169,
        description: "–ö–æ–ª–ª–∞–±–æ—Ä–∞—Ü–∏—è Jordan –∏ Supreme. –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –¥–∏–∑–∞–π–Ω –∏ –≤—ã—Å—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ. –≠–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã–π –ø—Ä–µ–¥–º–µ—Ç –≥–∞—Ä–¥–µ—Ä–æ–±–∞.",
        features: [
            "–ú–∞—Ç–µ—Ä–∏–∞–ª: –ø–æ–ª–∏—ç—Å—Ç–µ—Ä",
            "–£–Ω–∏–∫–∞–ª—å–Ω—ã–π –¥–∏–∑–∞–π–Ω –∫–æ–ª–ª–∞–±–æ—Ä–∞—Ü–∏–∏",
            "–§–∏—Ä–º–µ–Ω–Ω—ã–µ –ª–æ–≥–æ—Ç–∏–ø—ã",
            "–†–∞–∑–º–µ—Ä—ã: M, L"
        ],
        images: [
            "–ñ–ò–õ–ï–¢–ö–ò JORDAN & SUPREME–±–µ–ª1.jpg",
            "–ñ–ò–õ–ï–¢–ö–ò JORDAN & SUPREME–±–µ–ª2.jpg",
            "–ñ–ò–õ–ï–¢–ö–ò JORDAN & SUPREME–±–µ–ª3.jpg",
            "–ñ–ò–õ–ï–¢–ö–ò JORDAN & SUPREME–±–µ–ª4.jpg",
            "–ñ–ò–õ–ï–¢–ö–ò JORDAN & SUPREME–±–µ–ª5.jpg",
            "–ñ–ò–õ–ï–¢–ö–ò JORDAN & SUPREME–±–µ–ª6.jpg",
            "–ñ–ò–õ–ï–¢–ö–ò JORDAN & SUPREME–±–µ–ª7.jpg"
        ]
    },
    10: {
        name: "–ñ–∏–ª–µ—Ç–∫–∞ Nike ACG",
        brand: "nike",
        price: 124,
        description: "–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –∂–∏–ª–µ—Ç–∫–∞ Nike ACG –¥–ª—è –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –æ—Ç–¥—ã—Ö–∞ –∏ –≥–æ—Ä–æ–¥—Å–∫–æ–≥–æ —Å—Ç–∏–ª—è. –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã.",
        features: [
            "–ú–∞—Ç–µ—Ä–∏–∞–ª: —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—á–Ω–∞—è —Ç–∫–∞–Ω—å Nike",
            "–í–æ–¥–æ–æ—Ç—Ç–∞–ª–∫–∏–≤–∞—é—â–∏–µ —Å–≤–æ–π—Å—Ç–≤–∞",
            "–°–≤–µ—Ç–æ–æ—Ç—Ä–∞–∂–∞—é—â–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã",
            "–†–∞–∑–º–µ—Ä—ã: M, L"
        ],
        images: [
            "–ñ–ò–õ–ï–¢–ö–ò NIKEasg1.jpg",
            "–ñ–ò–õ–ï–¢–ö–ò NIKEasg2.jpg",
            "–ñ–ò–õ–ï–¢–ö–ò NIKEasg3.jpg",
            "–ñ–ò–õ–ï–¢–ö–ò NIKEasg4.jpg",
            "–ñ–ò–õ–ï–¢–ö–ò NIKEasg5.jpg",
            "–ñ–ò–õ–ï–¢–ö–ò NIKEasg6.jpg",
            "–ñ–ò–õ–ï–¢–ö–ò NIKEasg7.jpg"
        ]
    },
    11: {
        name: "–ñ–∏–ª–µ—Ç–∫–∞ Polo Ralph Lauren",
        brand: "polo",
        price: 119,
        description: "–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –∂–∏–ª–µ—Ç–∫–∞ Polo Ralph Lauren. –≠–ª–µ–≥–∞–Ω—Ç–Ω–æ—Å—Ç—å –∏ –∫–∞—á–µ—Å—Ç–≤–æ. –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å—Ç–∏–ª–µ–π.",
        features: [
            "–ú–∞—Ç–µ—Ä–∏–∞–ª: —Ö–ª–æ–ø–æ–∫/–Ω–µ–π–ª–æ–Ω",
            "–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –¥–∏–∑–∞–π–Ω",
            "–§–∏—Ä–º–µ–Ω–Ω—ã–π –ª–æ–≥–æ—Ç–∏–ø",
            "–†–∞–∑–º–µ—Ä—ã: S, M, L, XL"
        ],
        images: [
            "–ñ–ò–õ–ï–¢–ö–ò POLO RALPH LAUREN1.jpg",
            "–ñ–ò–õ–ï–¢–ö–ò POLO RALPH LAUREN2.jpg",
            "–ñ–ò–õ–ï–¢–ö–ò POLO RALPH LAUREN3.jpg",
            "–ñ–ò–õ–ï–¢–ö–ò POLO RALPH LAUREN4.jpg",
            "–ñ–∏–õ–ï–¢–ö–ò POLO RALPH LAUREN5.jpg",
            "–ñ–ò–õ–ï–¢–ö–ò POLO RALPH LAUREN6.jpg",
            "–ñ–ò–õ–ï–¢–ö–ò POLO RALPH LAUREN7.jpg",
            "–ñ–ò–õ–ï–¢–ö–ò POLO RALPH LAUREN8.jpg"
        ]
    },
    12: {
        name: "–ñ–∏–ª–µ—Ç–∫–∞ Prada",
        brand: "prada",
        price: 189,
        description: "–†–æ—Å–∫–æ—à–Ω–∞—è –∂–∏–ª–µ—Ç–∫–∞ –æ—Ç Prada. –ü—Ä–µ–º–∏–∞–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –∏ –∏–¥–µ–∞–ª—å–Ω–∞—è –ø–æ—Å–∞–¥–∫–∞. –í—ã—Å—à–∏–π —É—Ä–æ–≤–µ–Ω—å –∫–∞—á–µ—Å—Ç–≤–∞.",
        features: [
            "–ú–∞—Ç–µ—Ä–∏–∞–ª: –ø—Ä–µ–º–∏–∞–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã",
            "–ò–¥–µ–∞–ª—å–Ω–∞—è –ø–æ—Å–∞–¥–∫–∞",
            "–§–∏—Ä–º–µ–Ω–Ω–∞—è —Ñ—É—Ä–Ω–∏—Ç—É—Ä–∞",
            "–†–∞–∑–º–µ—Ä—ã: M, L"
        ],
        images: [
            "–ñ–ò–õ–ï–¢–ö–ò PRADA1.jpg",
            "–ñ–ò–õ–ï–¢–ö–ò PRADA2.jpg",
            "–ñ–ò–õ–ï–¢–ö–ò PRADA3.jpg",
            "–ñ–ò–õ–ï–¢–ö–ò PRADA4.jpg",
            "–ñ–ò–õ–ï–¢–ö–ò PRADA5.jpg",
            "–ñ–ò–õ–ï–¢–ö–ò PRADA6.jpg",
        ]
    }
};

// –ö–æ—Ä–∑–∏–Ω–∞
let cart = JSON.parse(localStorage.getItem('cart')) || [];

// –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–æ–∑–∏—Ü–∏–∏ –ø—Ä–æ–∫—Ä—É—Ç–∫–∏
let scrollPosition = 0;

// –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
document.addEventListener('DOMContentLoaded', function() {
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
    initApp();

    // –°–∫—Ä—ã–≤–∞–µ–º –ø—Ä–µ–ª–æ–∞–¥–µ—Ä –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏
    window.addEventListener('load', function() {
        setTimeout(function() {
            document.getElementById('preloader').style.display = 'none';
        }, 1000);
    });
});

function initApp() {
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ—Ä–∑–∏–Ω—ã
    initCart();

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π
    initCategories();

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
    initModals();

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞
    initQuickView();

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–Ω–æ–ø–æ–∫ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –∫–æ—Ä–∑–∏–Ω—É
    initAddToCartButtons();

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤
    initAdvantageModals();

    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫ –∫–æ—Ä–∑–∏–Ω—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
    updateCartCount();
}

function initCart() {
    updateCartCount();

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—Ç–∫—Ä—ã—Ç–∏—è –∫–æ—Ä–∑–∏–Ω—ã
    document.getElementById('cart-toggle').addEventListener('click', function() {
        openCart();
    });

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∑–∞–∫—Ä—ã—Ç–∏—è –∫–æ—Ä–∑–∏–Ω—ã
    document.querySelector('.close-btn').addEventListener('click', function() {
        closeCart();
    });

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ "–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑"
    document.getElementById('order-btn').addEventListener('click', function() {
        if (cart.length === 0) {
            showToast('–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞', 'error');
            return;
        }

        const orderText = generateOrderText();
        const telegramUsername = 'bigdigovich';
        const encodedText = encodeURIComponent(orderText);

        // –û—Ç–∫—Ä—ã–≤–∞–µ–º Telegram —Å –∑–∞–∫–∞–∑–æ–º
        openTelegramLink(encodedText, telegramUsername);

        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
        showToast('–ó–∞–∫–∞–∑ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –≤ Telegram', 'success');

        // –ù–µ –æ—á–∏—â–∞–µ–º –∫–æ—Ä–∑–∏–Ω—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ - –ø—É—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–∞–º —Ä–µ—à–∏—Ç
    });

    // –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –æ—Ç–∫—Ä—ã—Ç–∏—è Telegram
    function openTelegramLink(encodedText, username) {
        const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);

        if (isMobile) {
            // –ü—Ä–æ–±—É–µ–º –æ—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ Telegram
            window.location.href = `tg://resolve?domain=${username}&text=${encodedText}`;

            // –ï—Å–ª–∏ –Ω–µ –æ—Ç–∫—Ä—ã–ª–æ—Å—å ‚Äî fallback –Ω–∞ –≤–µ–± —á–µ—Ä–µ–∑ 500 –º—Å
            setTimeout(() => {
                window.open(`https://t.me/${username}?text=${encodedText}`, '_blank');
            }, 500);
        } else {
            // –ù–∞ –ü–ö —Å—Ä–∞–∑—É –æ—Ç–∫—Ä—ã–≤–∞–µ–º –≤–µ–±-–≤–µ—Ä—Å–∏—é
            window.open(`https://t.me/${username}?text=${encodedText}`, '_blank');
        }
    }

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ "–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∑–∞–∫–∞–∑"
    document.getElementById('copy-order-btn').addEventListener('click', function() {
        if (cart.length === 0) {
            showToast('–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞', 'error');
            return;
        }

        const orderText = generateOrderText();

        // –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π API –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞
        if (navigator.clipboard && window.isSecureContext) {
            navigator.clipboard.writeText(orderText)
                .then(() => {
                    showToast('–ó–∞–∫–∞–∑ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞');
                })
                .catch(err => {
                    // Fallback –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤
                    copyToClipboardFallback(orderText);
                });
        } else {
            // Fallback –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤
            copyToClipboardFallback(orderText);
        }
    });

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –≤—ã–±–æ—Ä–∞ —Å–ø–æ—Å–æ–±–∞ –æ–ø–ª–∞—Ç—ã
    document.querySelectorAll('.payment-method').forEach(method => {
        method.addEventListener('click', function() {
            // –°–Ω–∏–º–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Å–æ –≤—Å–µ—Ö –º–µ—Ç–æ–¥–æ–≤
            document.querySelectorAll('.payment-method').forEach(m => {
                m.classList.remove('selected');
            });

            // –í—ã–¥–µ–ª—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π –º–µ—Ç–æ–¥
            this.classList.add('selected');

            // –ü—Ä–æ–≥—Ä–∞–º–º–Ω–æ –≤—ã–±–∏—Ä–∞–µ–º radio-–∫–Ω–æ–ø–∫—É
            const radio = this.querySelector('input[type="radio"]');
            if (radio) {
                radio.checked = true;
            }
        });
    });

    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±–∏—Ä–∞–µ–º –ø–µ—Ä–≤—ã–π —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã
    const firstPaymentMethod = document.querySelector('.payment-method');
    if (firstPaymentMethod) {
        firstPaymentMethod.classList.add('selected');
        const radio = firstPaymentMethod.querySelector('input[type="radio"]');
        if (radio) {
            radio.checked = true;
        }
    }
}

// –û—Ç–∫—Ä—ã—Ç–∏–µ –∫–æ—Ä–∑–∏–Ω—ã
function openCart() {
    document.getElementById('cart-sidebar').classList.add('active');
    document.getElementById('overlay').classList.add('active');
    document.body.style.overflow = 'hidden';
    renderCartItems();

    // –í–∏–±—Ä–∞—Ü–∏—è –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –∫–æ—Ä–∑–∏–Ω—ã
    if ('vibrate' in navigator) {
        navigator.vibrate(30);
    }
}

// –ó–∞–∫—Ä—ã—Ç–∏–µ –∫–æ—Ä–∑–∏–Ω—ã
function closeCart() {
    document.getElementById('cart-sidebar').classList.remove('active');
    document.getElementById('overlay').classList.remove('active');
    document.body.style.overflow = 'auto';
}

// Fallback –º–µ—Ç–æ–¥ –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞
function copyToClipboardFallback(text) {
    const textArea = document.createElement('textarea');
    textArea.value = text;
    textArea.style.position = 'fixed';
    textArea.style.opacity = '0';
    document.body.appendChild(textArea);
    textArea.select();

    try {
        const successful = document.execCommand('copy');
        if (successful) {
            showToast('–ó–∞–∫–∞–∑ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞');
        } else {
            showToast('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∑–∞–∫–∞–∑', 'error');
        }
    } catch (err) {
        showToast('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∑–∞–∫–∞–∑', 'error');
    }

    document.body.removeChild(textArea);
}

function addToCart(productId, size = 'M') {
    const product = products[productId];
    if (!product) return;

    const existingItemIndex = cart.findIndex(item =>
        item.id === productId && item.size === size
    );

    if (existingItemIndex !== -1) {
        cart[existingItemIndex].quantity += 1;
    } else {
        cart.push({
            id: productId,
            name: product.name,
            price: product.price,
            size: size,
            quantity: 1,
            image: product.images[0]
        });
    }

    localStorage.setItem('cart', JSON.stringify(cart));
    updateCartCount();
    showToast('–¢–æ–≤–∞—Ä –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∫–æ—Ä–∑–∏–Ω—É üõí');

    // –ê–Ω–∏–º–∞—Ü–∏—è "–ø–æ–ª–µ—Ç–∞" –≤ –∫–æ—Ä–∑–∏–Ω—É
    createFlyToCartAnimation();

    // –û–±–Ω–æ–≤–ª—è–µ–º –∫–æ—Ä–∑–∏–Ω—É –µ—Å–ª–∏ –æ–Ω–∞ –æ—Ç–∫—Ä—ã—Ç–∞
    if (document.getElementById('cart-sidebar').classList.contains('active')) {
        renderCartItems();
    }
}

// –°–æ–∑–¥–∞–Ω–∏–µ –∞–Ω–∏–º–∞—Ü–∏–∏ "–ø–æ–ª–µ—Ç–∞" —Ç–æ–≤–∞—Ä–∞ –≤ –∫–æ—Ä–∑–∏–Ω—É
function createFlyToCartAnimation() {
    const flyElement = document.createElement('div');
    flyElement.className = 'fly-to-cart';
    flyElement.innerHTML = '<i class="fas fa-shopping-cart"></i>';

    // –ü–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä—É–µ–º —ç–ª–µ–º–µ–Ω—Ç –≤ —Ü–µ–Ω—Ç—Ä–µ —ç–∫—Ä–∞–Ω–∞
    const viewportWidth = window.innerWidth;
    const viewportHeight = window.innerHeight;

    flyElement.style.left = (viewportWidth / 2 - 30) + 'px';
    flyElement.style.top = (viewportHeight / 2 - 30) + 'px';

    // –ö–æ–Ω–µ—á–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è (–∏–∫–æ–Ω–∫–∞ –∫–æ—Ä–∑–∏–Ω—ã)
    const cartBtn = document.getElementById('cart-toggle');
    const cartRect = cartBtn.getBoundingClientRect();
    const endX = cartRect.left + cartRect.width / 2 - 30;
    const endY = cartRect.top + cartRect.height / 2 - 30;

    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º CSS –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏
    document.documentElement.style.setProperty('--fly-x', (endX - viewportWidth / 2) + 'px');
    document.documentElement.style.setProperty('--fly-y', (endY - viewportHeight / 2) + 'px');
    document.documentElement.style.setProperty('--fly-end-x', (endX - viewportWidth / 2) * 2 + 'px');
    document.documentElement.style.setProperty('--fly-end-y', (endY - viewportHeight / 2) * 2 + 'px');

    document.body.appendChild(flyElement);

    // –£–¥–∞–ª—è–µ–º —ç–ª–µ–º–µ–Ω—Ç –ø–æ—Å–ª–µ –∞–Ω–∏–º–∞—Ü–∏–∏
    setTimeout(() => {
        document.body.removeChild(flyElement);
    }, 1000);
}

function removeFromCart(index) {
    if (index >= 0 && index < cart.length) {
        const itemElement = document.querySelectorAll('.cart-item')[index];
        if (itemElement) {
            itemElement.classList.add('cart-item-removing');

            setTimeout(() => {
                cart.splice(index, 1);
                localStorage.setItem('cart', JSON.stringify(cart));
                updateCartCount();
                renderCartItems();
                showToast('–¢–æ–≤–∞—Ä —É–¥–∞–ª–µ–Ω –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã');
            }, 300);
        }
    }
}

function updateCartCount() {
    const count = cart.reduce((total, item) => total + item.quantity, 0);
    const cartBadge = document.getElementById('cart-count');

    if (cartBadge) {
        cartBadge.textContent = count;

        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º/—Å–∫—Ä—ã–≤–∞–µ–º –±–µ–π–¥–∂
        if (count > 0) {
            cartBadge.style.display = 'flex';
        } else {
            cartBadge.style.display = 'none';
        }

        // –ê–Ω–∏–º–∞—Ü–∏—è —Å—á–µ—Ç—á–∏–∫–∞
        cartBadge.classList.add('pulse');
        setTimeout(() => {
            cartBadge.classList.remove('pulse');
        }, 500);
    }
}

function updateQuantity(index, change) {
    if (index >= 0 && index < cart.length) {
        const newQuantity = cart[index].quantity + change;

        if (newQuantity < 1) {
            removeFromCart(index);
            return;
        }

        cart[index].quantity = newQuantity;
        localStorage.setItem('cart', JSON.stringify(cart));
        updateCartCount();
        renderCartItems();

        // –í–∏–±—Ä–∞—Ü–∏—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞
        if ('vibrate' in navigator) {
            navigator.vibrate(20);
        }
    }
}

function renderCartItems() {
    const cartContent = document.getElementById('cart-content');
    const cartTotal = document.getElementById('cart-total-price');
    const progressBar = document.getElementById('cart-progress-bar');
    const freeShippingInfo = document.getElementById('free-shipping-info');
    const shippingInfo = document.getElementById('shipping-info');

    if (!cartContent) return;

    if (cart.length === 0) {
        cartContent.innerHTML = `
            <div class="cart-empty">
                <i class="fas fa-shopping-basket" style="font-size: 4rem; margin-bottom: 1rem;"></i>
                <p>–í–∞—à–∞ –∫–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞</p>
                <p style="color: var(--gray); font-size: 0.9rem; margin-top: 0.5rem;">–î–æ–±–∞–≤—å—Ç–µ —Ç–æ–≤–∞—Ä—ã, —á—Ç–æ–±—ã –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å</p>
            </div>
        `;
        if (cartTotal) cartTotal.textContent = '0 BYN';
        if (progressBar) progressBar.style.width = '0%';
        if (freeShippingInfo) freeShippingInfo.style.display = 'none';
        if (shippingInfo) shippingInfo.style.display = 'none';
        return;
    }

    let total = 0;
    let itemsHTML = '';

    cart.forEach((item, index) => {
        const itemTotal = item.price * item.quantity;
        total += itemTotal;

        itemsHTML += `
            <div class="cart-item" style="animation-delay: ${index * 0.1}s">
                <img src="${item.image}" alt="${item.name}" class="cart-item-image" loading="lazy" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iODAiIHZpZXdCb3g9IjAgMCA4MCA4MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjgwIiBoZWlnaHQ9IjgwIiBmaWxsPSIjRjNGNEY2Ii8+Cjx0ZXh0IHg9IjQwIiB5PSI0MCIgZG9taW5hbnQtYmFzZWxpbmU9Im1pZGRsZSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZm9udC1mYW1pbHk9IkFyaWFsLCBzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBmaWxsPSIjNjQ2NDY0Ij5ObyBpbWFnZTwvdGV4dD4KPC9zdmc+'>">
                <div class="cart-item-details">
                    <div class="cart-item-name">${item.name}</div>
                    <div class="cart-item-price">${item.price} BYN √ó ${item.quantity} = ${itemTotal} BYN</div>
                    <div class="cart-item-size">–†–∞–∑–º–µ—Ä: ${item.size}</div>
                    <div class="cart-item-actions">
                        <div class="quantity-control">
                            <button class="quantity-btn" onclick="updateQuantity(${index}, -1)">-</button>
                            <span class="quantity">${item.quantity}</span>
                            <button class="quantity-btn" onclick="updateQuantity(${index}, 1)">+</button>
                        </div>
                        <button class="remove-item" onclick="removeFromCart(${index})" title="–£–¥–∞–ª–∏—Ç—å —Ç–æ–≤–∞—Ä">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
            </div>
        `;
    });

    cartContent.innerHTML = itemsHTML;
    if (cartTotal) cartTotal.textContent = `${total} BYN`;

    // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –±–µ—Å–ø–ª–∞—Ç–Ω–æ–π –¥–æ—Å—Ç–∞–≤–∫–∏
    updateShippingProgress(total);
}

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –±–µ—Å–ø–ª–∞—Ç–Ω–æ–π –¥–æ—Å—Ç–∞–≤–∫–∏
function updateShippingProgress(total) {
    const progressBar = document.getElementById('cart-progress-bar');
    const freeShippingInfo = document.getElementById('free-shipping-info');
    const shippingInfo = document.getElementById('shipping-info');

    const freeShippingThreshold = 200;
    const progress = Math.min((total / freeShippingThreshold) * 100, 100);

    if (progressBar) {
        progressBar.style.width = `${progress}%`;
    }

    if (freeShippingInfo && shippingInfo) {
        if (total >= freeShippingThreshold) {
            freeShippingInfo.style.display = 'block';
            shippingInfo.style.display = 'none';
            freeShippingInfo.innerHTML = 'üéâ –í—ã –ø–æ–ª—É—á–∏–ª–∏ –±–µ—Å–ø–ª–∞—Ç–Ω—É—é –¥–æ—Å—Ç–∞–≤–∫—É!';
        } else {
            freeShippingInfo.style.display = 'none';
            shippingInfo.style.display = 'block';
            const remaining = freeShippingThreshold - total;
            shippingInfo.innerHTML = `–î–æ –±–µ—Å–ø–ª–∞—Ç–Ω–æ–π –¥–æ—Å—Ç–∞–≤–∫–∏ –æ—Å—Ç–∞–ª–æ—Å—å: ${remaining} BYN`;
        }
    }
}

function generateOrderText() {
    // –ü–æ–ª—É—á–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã
    const selectedPayment = document.querySelector('input[name="payment-method"]:checked');
    const paymentMethod = selectedPayment ? selectedPayment.value : '–ù–∞–ª–∏—á–Ω—ã–µ';

    let text = "üõçÔ∏è –ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –•–æ—á—É –æ—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑:\n\n";
    let total = 0;

    cart.forEach(item => {
        const itemTotal = item.price * item.quantity;
        total += itemTotal;
        text += `‚Ä¢ ${item.name} (–†–∞–∑–º–µ—Ä: ${item.size}) - ${item.quantity} —à—Ç. √ó ${item.price} BYN = ${itemTotal} BYN\n`;
    });

    text += `\nüí∞ –ò—Ç–æ–≥–æ: ${total} BYN`;
    text += `\nüí≥ –°–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã: ${paymentMethod}`;

    // –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –±–µ—Å–ø–ª–∞—Ç–Ω–æ–π –¥–æ—Å—Ç–∞–≤–∫–µ
    if (total >= 200) {
        text += "\nüöö –î–æ—Å—Ç–∞–≤–∫–∞: –ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è";
    } else {
        text += "\nüöö –î–æ—Å—Ç–∞–≤–∫–∞: 15 BYN";
    }

    text += "\n\nüì¶ –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–∫–∞–∂–∏—Ç–µ –∞–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏ –∏ —É–¥–æ–±–Ω–æ–µ –≤—Ä–µ–º—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞.";

    return text;
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∫–∞–∑–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
function showToast(message, type = 'success') {
    // –°–æ–∑–¥–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
    const toast = document.createElement('div');
    toast.className = `toast ${type}`;
    toast.innerHTML = `
        <div class="toast-content">
            <i class="fas ${type === 'success' ? 'fa-check-circle' : 'fa-exclamation-circle'}"></i>
            <span>${message}</span>
        </div>
    `;

    // –î–æ–±–∞–≤–ª—è–µ–º –≤ DOM
    document.body.appendChild(toast);

    // –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è
    setTimeout(() => {
        toast.classList.add('show');
    }, 10);

    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–∫—Ä—ã—Ç–∏–µ —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
    setTimeout(() => {
        toast.classList.remove('show');
        setTimeout(() => {
            document.body.removeChild(toast);
        }, 300);
    }, 3000);
}

// –û—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (initCategories, initModals, initQuickView –∏ —Ç.–¥.) –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
// ... [–æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ —Ñ—É–Ω–∫—Ü–∏–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏] ...

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–Ω–æ–ø–æ–∫ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –∫–æ—Ä–∑–∏–Ω—É
function initAddToCartButtons() {
    document.addEventListener('click', function(e) {
        if (e.target.closest('.add-to-cart-btn')) {
            const productId = e.target.closest('.add-to-cart-btn').dataset.productId;
            const sizeSelect = document.querySelector(`.product-card[data-product-id="${productId}"] .size-select`);
            const size = sizeSelect ? sizeSelect.value : 'M';

            addToCart(productId, size);

            // –ê–Ω–∏–º–∞—Ü–∏—è –∫–Ω–æ–ø–∫–∏
            const btn = e.target.closest('.add-to-cart-btn');
            btn.classList.add('adding');
            setTimeout(() => {
                btn.classList.remove('adding');
            }, 1000);
        }
    });
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ–±—â–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∫–æ—Ä–∑–∏–Ω–µ
function updateTotalItemsCount() {
    const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
    const totalElement = document.getElementById('cart-total-items');
    if (totalElement) {
        totalElement.textContent = totalItems;
    }
}

// –û–±–Ω–æ–≤–ª—è–µ–º –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∫–æ—Ä–∑–∏–Ω—ã
function updateCartCount() {
    const count = cart.reduce((total, item) => total + item.quantity, 0);
    const cartBadge = document.getElementById('cart-count');

    if (cartBadge) {
        cartBadge.textContent = count;
        cartBadge.style.display = count > 0 ? 'flex' : 'none';

        // –ê–Ω–∏–º–∞—Ü–∏—è
        cartBadge.classList.add('pulse');
        setTimeout(() => cartBadge.classList.remove('pulse'), 500);
    }

    updateTotalItemsCount();
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤
function initAdvantageModals() {
    const advantageButtons = document.querySelectorAll('.advantage-btn');
    const advantageModal = document.getElementById('advantage-modal');
    const closeModal = advantageModal.querySelector('.close-modal');

    advantageButtons.forEach(btn => {
        btn.addEventListener('click', function() {
            const advantageType = this.dataset.advantage;
            showAdvantageModal(advantageType);
        });
    });

    closeModal.addEventListener('click', function() {
        advantageModal.classList.remove('active');
        document.getElementById('overlay').classList.remove('active');
        document.body.style.overflow = 'auto';
    });
}

function showAdvantageModal(type) {
    const modal = document.getElementById('advantage-modal');
    const title = modal.querySelector('.modal-title');
    const content = modal.querySelector('.modal-content');

    const advantages = {
        quality: {
            title: '–ö–∞—á–µ—Å—Ç–≤–æ 1:1',
            content: '–í—Å–µ –Ω–∞—à–∏ —Ç–æ–≤–∞—Ä—ã –ø—Ä–æ—Ö–æ–¥—è—Ç —Å—Ç—Ä–æ–≥–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å –∫–∞—á–µ—Å—Ç–≤–∞. –ú—ã –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ–º –ø–æ–ª–Ω–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –æ—Ä–∏–≥–∏–Ω–∞–ª—É –ø–æ –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º, –ø–æ—à–∏–≤—É –∏ –¥–µ—Ç–∞–ª—è–º.'
        },
        delivery: {
            title: '–ë—ã—Å—Ç—Ä–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞',
            content: '–î–æ—Å—Ç–∞–≤–∫–∞ –ø–æ –≤—Å–µ–º—É –º–∏—Ä—É –æ—Ç 3 –¥–æ 14 –¥–Ω–µ–π. –ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞ –ø—Ä–∏ –∑–∞–∫–∞–∑–µ –æ—Ç 200 BYN. –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.'
        },
        support: {
            title: '–ü–æ–¥–¥–µ—Ä–∂–∫–∞ 24/7',
            content: '–ù–∞—à–∞ —Å–ª—É–∂–±–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫—Ä—É–≥–ª–æ—Å—É—Ç–æ—á–Ω–æ. –ü–æ–º–æ–∂–µ–º —Å –≤—ã–±–æ—Ä–æ–º —Ä–∞–∑–º–µ—Ä–∞, –æ—Ç–≤–µ—Ç–∏–º –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –∏ —Ä–µ—à–∏–º –ª—é–±—ã–µ –ø—Ä–æ–±–ª–µ–º—ã.'
        }
    };

    if (advantages[type]) {
        title.textContent = advantages[type].title;
        content.innerHTML = `<p>${advantages[type].content}</p>`;
        modal.classList.add('active');
        document.getElementById('overlay').classList.add('active');
        document.body.style.overflow = 'hidden';
    }
}

// –î–æ–±–∞–≤–ª—è–µ–º —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –ø–ª–∞–≤–Ω–æ–π –ø—Ä–æ–∫—Ä—É—Ç–∫–∏
function smoothScrollTo(target) {
    const element = document.querySelector(target);
    if (element) {
        element.scrollIntoView({
            behavior: 'smooth',
            block: 'start'
        });
    }
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–ª–∞–π–¥–µ—Ä–æ–≤
function initSliders() {
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≥–ª–∞–≤–Ω–æ–≥–æ —Å–ª–∞–π–¥–µ—Ä–∞
    const mainSlider = document.querySelector('.main-slider');
    if (mainSlider) {
        let currentSlide = 0;
        const slides = mainSlider.querySelectorAll('.slide');
        const totalSlides = slides.length;

        function showSlide(index) {
            slides.forEach((slide, i) => {
                slide.classList.remove('active');
                if (i === index) {
                    slide.classList.add('active');
                }
            });
        }

        function nextSlide() {
            currentSlide = (currentSlide + 1) % totalSlides;
            showSlide(currentSlide);
        }

        // –ê–≤—Ç–æ–ø—Ä–æ–∫—Ä—É—Ç–∫–∞ —Å–ª–∞–π–¥–µ—Ä–∞
        setInterval(nextSlide, 5000);
    }
}

// –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è UX
document.addEventListener('DOMContentLoaded', function() {
    // –ü–ª–∞–≤–Ω–∞—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∞ –¥–ª—è —è–∫–æ—Ä–µ–π
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            const target = this.getAttribute('href');
            if (target !== '#') {
                smoothScrollTo(target);
            }
        });
    });

    // –õ–µ–Ω–∏–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
    if ('IntersectionObserver' in window) {
        const lazyImages = document.querySelectorAll('img[data-src]');

        const imageObserver = new IntersectionObserver((entries, observer) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const img = entry.target;
                    img.src = img.dataset.src;
                    img.removeAttribute('data-src');
                    imageObserver.unobserve(img);
                }
            });
        });

        lazyImages.forEach(img => {
            imageObserver.observe(img);
        });
    }

    // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è overlay
    document.getElementById('overlay').addEventListener('click', function() {
        closeCart();

        // –ó–∞–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –º–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞
        document.querySelectorAll('.modal.active').forEach(modal => {
            modal.classList.remove('active');
        });

        this.classList.remove('active');
        document.body.style.overflow = 'auto';
    });

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–ª–∞–π–¥–µ—Ä–æ–≤
    initSliders();

    // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ "–ù–∞–≤–µ—Ä—Ö"
    const scrollToTopBtn = document.createElement('button');
    scrollToTopBtn.innerHTML = '<i class="fas fa-chevron-up"></i>';
    scrollToTopBtn.className = 'scroll-to-top';
    scrollToTopBtn.style.cssText = `
        position: fixed;
        bottom: 30px;
        right: 30px;
        width: 50px;
        height: 50px;
        border-radius: 50%;
        background: var(--secondary);
        color: white;
        border: none;
        cursor: pointer;
        display: none;
        align-items: center;
        justify-content: center;
        font-size: 1.2rem;
        box-shadow: var(--shadow);
        transition: all 0.3s ease;
        z-index: 1000;
    `;

    scrollToTopBtn.addEventListener('mouseenter', function() {
        this.style.transform = 'translateY(-3px)';
        this.style.boxShadow = '0 6px 20px rgba(52, 152, 219, 0.4)';
    });

    scrollToTopBtn.addEventListener('mouseleave', function() {
        this.style.transform = 'translateY(0)';
        this.style.boxShadow = 'var(--shadow)';
    });

    scrollToTopBtn.addEventListener('click', function() {
        window.scrollTo({
            top: 0,
            behavior: 'smooth'
        });
    });

    document.body.appendChild(scrollToTopBtn);

    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º/—Å–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –ø—Ä–∏ –ø—Ä–æ–∫—Ä—É—Ç–∫–µ
    window.addEventListener('scroll', function() {
        if (window.pageYOffset > 300) {
            scrollToTopBtn.style.display = 'flex';
        } else {
            scrollToTopBtn.style.display = 'none';
        }
    });

    // –î–æ–±–∞–≤–ª—è–µ–º –∞–Ω–∏–º–∞—Ü–∏–∏ –ø—Ä–∏ —Å–∫—Ä–æ–ª–ª–µ
    const animateOnScroll = function() {
        const elements = document.querySelectorAll('.product-card, .advantage-card, .category-card');

        elements.forEach(element => {
            const elementTop = element.getBoundingClientRect().top;
            const elementVisible = 150;

            if (elementTop < window.innerHeight - elementVisible) {
                element.classList.add('animate');
            }
        });
    };

    window.addEventListener('scroll', animateOnScroll);
    // –ó–∞–ø—É—Å–∫–∞–µ–º —Å—Ä–∞–∑—É –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
    animateOnScroll();
});

// –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–¥–¥–µ—Ä–∂–∫—É PWA
if ('serviceWorker' in navigator) {
    window.addEventListener('load', function() {
        navigator.serviceWorker.register('/sw.js').then(function(registration) {
            console.log('ServiceWorker registration successful');
        }, function(err) {
            console.log('ServiceWorker registration failed: ', err);
        });
    });
}

// –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç–µ–º—ã
function initTheme() {
    const themeToggle = document.createElement('button');
    themeToggle.innerHTML = '<i class="fas fa-moon"></i>';
    themeToggle.className = 'theme-toggle';
    themeToggle.title = '–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É';

    themeToggle.style.cssText = `
        position: fixed;
        bottom: 90px;
        right: 30px;
        width: 50px;
        height: 50px;
        border-radius: 50%;
        background: var(--secondary);
        color: white;
        border: none;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.2rem;
        box-shadow: var(--shadow);
        transition: all 0.3s ease;
        z-index: 1000;
    `;

    themeToggle.addEventListener('click', function() {
        document.body.classList.toggle('dark-theme');
        const isDark = document.body.classList.contains('dark-theme');
        localStorage.setItem('theme', isDark ? 'dark' : 'light');

        this.innerHTML = isDark ? '<i class="fas fa-sun"></i>' : '<i class="fas fa-moon"></i>';
    });

    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—É—é —Ç–µ–º—É
    const savedTheme = localStorage.getItem('theme');
    if (savedTheme === 'dark') {
        document.body.classList.add('dark-theme');
        themeToggle.innerHTML = '<i class="fas fa-sun"></i>';
    }

    document.body.appendChild(themeToggle);
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Ç–µ–º—É –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
document.addEventListener('DOMContentLoaded', initTheme);